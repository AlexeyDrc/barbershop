<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">

<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Профиль</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">


    <link rel="stylesheet" th:href="@{/profile.css}"/>
</head>
<body>
<header th:insert="blocks/header :: header"></header>
<!--
<div class="container mt-3">
<div class="card p-3 text-center">
    <div class="d-flex flex-row justify-content-center mb-3">
        <div class="image"> <img src="https://i.imgur.com/hczKIze.jpg" class="rounded-circle"> <span><i class='bx bxs-camera-plus'></i></span> </div>
        <div class="d-flex flex-column ms-3 user-details">
            <h4 class="mb-0">Zenda Grace</h4>
            <div class="ratings"> <span>4.0</span> <i class='bx bx-star ms-1'></i> </div> <span>Pro Member</span>
        </div>
    </div>
    <h4>Edit Profile</h4>
    <div class="row">
        <div class="col-md-6">
            <div class="inputs"> <label>Name</label> <input class="form-control" type="text" placeholder="Name"> </div>
        </div>
        <div class="col-md-6">
            <div class="inputs"> <label>Email</label> <input class="form-control" type="text" placeholder="Email"> </div>
        </div>
        <div class="col-md-6">
            <div class="inputs"> <label>City</label> <input class="form-control" type="text" placeholder="City"> </div>
        </div>
        <div class="col-md-6">
            <div class="inputs"> <label>Country</label> <input class="form-control" type="text" placeholder="Country"> </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="about-inputs"> <label>About</label> <textarea class="form-control" type="text" placeholder="Tell us about yourself"> </textarea> </div>
        </div>
    </div>
    <div class="mt-3 gap-2 d-flex justify-content-end"> <button class="px-3 btn btn-sm btn-outline-primary">Cancel</button> <button class="px-3 btn btn-sm btn-primary">Save</button> </div>
</div>
</div>-->


<section class="py-5 text-center container">
    <div class="row py-lg-5">
        <div class="col-lg-6 col-md-8 mx-auto">
            <h1 class="fw-light">Ваш профиль</h1>
        </div>
    </div>
</section>


<div th:each="user: ${users}">
    <div class="col-md-7 ps-md-4">
        <div class="row">
            <div class="col-12 bg-white px-3 mb-3 pb-3">
                <div class="d-flex align-items-center justify-content-between border-bottom">
                    <div th:each="master : ${masters}">
                        <p th:if="${user.id} == ${master.userId}" th:text="${master.FIO}"
                           class="py-2 text-muted"></p>
                    </div>
                </div>
            </div>
        </div>
        <div sec:authorize="hasAuthority('ROLE_USER')">
            <div class="d-flex align-items-center justify-content-between border-bottom">
                <div th:each="customer : ${customers}" th:if="${user.id} == ${customer.userId}">
                    <p class="py-2">Имя</p>
                    <p th:text="${customer.customerName}"
                       class="py-2 text-muted"></p>
                    <p class="py-2">Номер телефона</p>
                    <p th:text="${customer.phoneNumber}"
                       class="py-2 text-muted"></p>
                    <p class="py-2">Каждый 10 заказ - скидка 50%</p>
                    <p th:text="${customer.completedOrders} + '/10'"
                       class="py-2 text-muted"></p>
                </div>
            </div>
        </div>
    </div>
    <div sec:authorize="hasAuthority('ROLE_ADMIN')">Администратор</div>
    <div sec:authorize="hasAuthority('ROLE_MASTER')">Мастер</div>
    <div sec:authorize="hasAuthority('ROLE_USER')">Пользователь</div>
    <div sec:authorize="hasAuthority('ROLE_ADMIN')">
        <a href="/admin" class="btn btn-primary follow me-2">АДМИН ПАНЕЛЬ</a>
    </div>
    <div sec:authorize="hasAuthority('ROLE_MASTER')">
        <a href="/myorders" class="btn btn-primary follow me-2">Ваши заказы</a>
    </div>
    <div sec:authorize="hasAuthority('ROLE_USER')">
        <p class="py-2 text-muted">Ваши записи</p>
    </div>
    <a class="btn btn-outline-primary message" href="/logout">Выйти</a>

    <div sec:authorize="hasAuthority('ROLE_USER')">
        <!-- <p class="py-2 text-muted">Ваши записи</p>
         <div th:each="customer : ${customers}" th:if="${customer.userId} == ${user.id}">
             <div th:each="order : ${orders}" th:if="${order.customerId} == ${customer.id}">
                 <div th:each="service : ${services}" th:if="${order.serviceTypeId} == ${service.id}">
                     <div th:text="${service.service_name} + ' - ' + ${service.service_price} + ' BYN'"></div>
                 </div>
             </div>
         </div>-->

        <!--<div th:each="customer : ${customers}" th:if="${customer.userId} == ${user.id}">
            <div th:each="order : ${orders}" th:if="${order.customerId} == ${customer.id}">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-12 d-flex justify-content-center right-bck">
                            <div class="registration-right">
                                <div class="event-list">
                                    <div class="card-body">
                                        <h4 class="card-title h5 h4-sm"><i class="fas fa-caret-right"aria-hidden="true"></i><span th:text="${order.date}"></span><i
                                                class="fas fa-caret-right" aria-hidden="true"></i>
                                            <div th:each="time : ${times}" th:if="${order.time} == ${time.id}">
                                            <span th:text="${time.time}"></span>
                                            </div>
                                        </h4>
                                        <div th:each="service : ${services}" th:if="${order.serviceTypeId} == ${service.id}">
                                        <p class="card-text"  th:text="'Услуга: ' + ${service.service_name}"></p>
                                        <p class="card-text"  th:text="'Цена: ' + ${service.service_price} + ' BYN'"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    -->

        <div class="container">
            <div class="table-responsive">
                <table class="table text-center">
                    <thead>
                    <tr>
                        <th>Мастер</th>
                        <th>Дата</th>
                        <th>Время</th>
                        <th>Услуга</th>
                        <th>Цена</th>
                        <th>Статус</th>
                    </tr>
                    </thead>
                    <tbody>

                    <div th:each="customer : ${customers}" th:if="${customer.userId} == ${user.id}">
                        <tr th:each="order : ${orders}" th:if="${order.customerId} == ${customer.id}">
                            <div th:each="master: ${masters}" th:if="${master.id} == ${order.masterId}">
                                <td th:text="${master.FIO}"></td>
                            </div>
                            <td th:text="${order.date}"></td>
                            <div th:each="time : ${times}" th:if="${order.time} == ${time.id}">
                                <td th:text="${time.time}"></td>
                            </div>
                            <div th:each="service : ${services}" th:if="${order.serviceTypeId} == ${service.id}">
                                <td th:text="${service.service_name}"></td>
                                <td th:if="${order.withDiscount}  == 0"
                                    th:text="${service.service_price} + ' BYN '"></td>
                                <td th:if="${order.withDiscount}  == 1"
                                    th:text="${service.service_price*0.5} + ' BYN (Скидка 50%)'"></td>
                            </div>

                            <td>
                                <div class="btn btn-success" th:if="${order.status} == 1">Выполнен</div>
                                <div class="btn btn-warning" th:if="${order.status} == 0">Запись создана</div>
                            </td>
                        </tr>
                    </div>
                    </tbody>
                </table>
            </div>
        </div>


    </div>
</div>

</div>
</div>
</div>
</div>
</div>

</body>
</html>